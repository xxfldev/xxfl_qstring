xxfl_qstring
==========


### 介绍：
* 本项目通过实现一个简单的C++字符串类 xxfl::qstring，来介绍一个可以加速字符串比较的小技巧。

* 项目提供了Code::Blocks 16及VS 2015下的测试工程。支持GCC和MSVC编译器。在Windows和Linux系统下编译运行通过。

* 该技巧原理很简单：通常ASCII或utf-8编码的字符串，相互间比较时是一个字节一个字节比的。但是我们可以把它转换成32位或64位无符号整数间的比较。这样实际的比较次数就会少很多，从而达到加速比较的目的。

* 要将字符串从按字节比较转为整数比较，需要整数以big-endian形式组织。由于现在通用CPU基本上都是little-endian的，因此在整数比较前需要做一次字节顺序颠倒。

* xxfl::qstring 用模板的形式提供了32位比较和64位比较两个版本。由于整数比较的原因，字符串缓冲区的大小需要向上取整到被4整除或者被8整除。理论上说会浪费一些内存。然而现在主流的内存分配机制会以4字节为最小分配单位，因此对于32位版本来说实际不存在内存浪费的问题。

* 实测结果：32位 xxfl::qstring 各项性能测试均优于 std::string。单纯字符串比较相对 std::string 耗时少一半左右；数组排序耗时少三分之一左右；在set中查找耗时少十分之一到四分之一不等。出乎意料的是：64位 xxfl::qstring 实际性能表现反而不如32位版本。

* 项目的主要目的在于展示技巧。xxfl::qstring 仅实现了用于测试的最低限度的功能。有心者可自行对其改造或扩展。


### 其他：
* 本项目是个人开源项目。代码可以自由使用，但是请自担风险。

* 项目主页：<https://github.com/xxfldev/xxfl_qstring>。只要还没下线就会长期维护。有任何相关问题或者建议欢迎联系。